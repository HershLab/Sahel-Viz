library(readxl)
library(tidyverse)
library(stargazer)
library(ggplot2)
library(popbio)
setwd('C:/Users/elmsc/Documents/school/econometrics/r/hw6')
set.seed(1994)
df <- read_excel("../data/8 - Logits.xlsx", sheet = "Export8")
mod1 <- lm(Pass ~ Hours, data = df)
summary(mod1)
# what is this regression called - linear probability model
# change x by one unit on average the probability of passing changes by
# increasing hours by one unit increases prob of passing by 8%
mod2 <-glm(Pass ~ Hours, family=binomial (link='logit'), data=df)
summary(mod2)
exp(coef(mod2))
# increasing hours by one unit increases the odds of passing are 2.62 times higher or
TestHours <- as.data.frame(c(1,5,10))
colnames(TestHours) <- c("Hours")
preds <- predict(mod2, TestHours)
prob_preds <- 1 / (1 + exp(-preds))
prob_preds
(coef(mod2))
exp(coef(mod2))
TestHours <- as.data.frame(c(1,5,10))
colnames(TestHours) <- c("Hours")
preds <- predict(mod2, TestHours)
prob_preds <- 1 / (1 + exp(-preds))
prob_preds
ggplot(df, aes(x=Hours, y=Pass)) + geom_point() +
stat_smooth(method="glm", method.args=list(family="binomial"), se=FALSE)
par(mar = c(4, 4, 1, 1)) # Reduce some of the margins so that the plot fits better
plot(df$Hours, df$Pass)
curve(predict(mod2, data.frame(Hours=x), type="response"), add=TRUE)
logi.hist.plot(df$Hours,df$Pass,boxp=FALSE,type="hist",col="gray")
df %>% group_by(Pass) %>% summarise(COUNT = n())
ggplot(df, aes(fill=Hours, y=Pass, x=Hours)) +
geom_bar(position="stack", stat="identity")
ggplot(df, aes(fill=Hours, y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
View(df)
df <- df %>% mutate('studies_alot' = case_when(Hours > 4 ~ 1, TRUE ~ 0))
ggplot(df, aes(fill=studies_alot, y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
ggplot(df, aes(fill=Hours, y=Hours, x=Pass)) +
geom_bar(position="fill", stat="identity")
studies_alot
ggplot(df, aes(fill=studies_alot, y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
ggplot(df, aes(fill=factor(studies_alot), y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
ggplot(df, aes(fill=factor(studies_alot), y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")+
scale_color_manual(labels = c("Studies < 5 Hours", "Studies 5 or more Hours"), values = c("blue", "red"))
geom_bar(position="stack", stat="identity")
ggplot(df, aes(fill=factor(studies_alot, y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity"))
ggplot(df, aes(fill=studies_alot, y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
View(df)
ggplot(df, aes(y=Hours, x=Pass)) +
geom_bar(position="stack", stat="identity")
aoi <- aoi %>% mutate(DATA_PER_1000 = total/POPULATION*1000,
NO_DATA = case_when(total == 0 ~ "No Data Available", TRUE ~ "Data Available"))
setwd('G:/.shortcut-targets-by-id/1ihZCdFkFKljvEUetC8IiiE7JEDSGKA4J/hersh_lab/sahel')
aoi <- st_read('combined/shp/sahel.shp')
library('tmap')
library('sf')
library('tidyverse')
setwd('G:/.shortcut-targets-by-id/1ihZCdFkFKljvEUetC8IiiE7JEDSGKA4J/hersh_lab/sahel')
aoi <- st_read('combined/shp/sahel.shp')
aoi <- aoi %>% mutate(DATA_PER_1000 = total/POPULATION*1000,
NO_DATA = case_when(total == 0 ~ "No Data Available", TRUE ~ "Data Available"))
View(aoi)
no_data <- tm_shape(aoi) + tm_polygons(col = "NO_DATA",n=2,labels = c("NO Data", "Minority"), title = "White and Minority\nZipcodes")
map_minority <- minority + tm_layout(scale = 1, frame = FALSE)
map_minority
no_data <- tm_shape(aoi) + tm_polygons(col = "NO_DATA",n=2,labels = c("NO Data", "Minority"), title = "White and Minority\nZipcodes")
map_data <- no_data + tm_layout(scale = 1, frame = FALSE)
map_data
aoi <- aoi %>% mutate(DATA_PER_1000 = total/POPULATION*1000,
NO_DATA = case_when(total == 0 ~ 0, TRUE ~ 1))
make_single_map <- function(x,y,name,col,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, style = "jenks", title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map <- tmap_arrange(map_lights, map_data)
map
tmap_save(map, filename = paste0("C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/output/", name,"i", col, ".png"))
}
make_map("left", "top", "Benin", "NO_DATA", "Data Availibility")
make_single_map("left", "top", "Benin", "NO_DATA", "Data Availibility")
make_single_map <- function(x,y,name,col,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, style = "jenks", title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/output/", name,"i", col, ".png"))
}
make_single_map("left", "top", "Benin", "NO_DATA", "Data Availibility")
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/output/", name,"i", col, ".png"))
}
View(aoi)
make_single_map_binary("left", "top", "Niger", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/output/", name,"-", col, ".png"))
}
make_single_map_binary("left", "top", "Niger", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Benin", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Burkina Faso", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Senegal", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Togo", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Niger", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Mauritania", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Mali", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "bottom", "Guinea", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Cote dlvoire", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
setwd('C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/')
sahel_loc <- 'G:/.shortcut-targets-by-id/1ihZCdFkFKljvEUetC8IiiE7JEDSGKA4J/hersh_lab/sahel'
setwd('C:/Users/elmsc/Documents/gis/hersh/Sahel-ID/')
sahel_loc <- 'G:/.shortcut-targets-by-id/1ihZCdFkFKljvEUetC8IiiE7JEDSGKA4J/hersh_lab/sahel/'
aoi <- st_read(paste0(sahel_loc,'combined/shp/sahel.shp'))
aoi <- aoi %>% mutate(DATA_PER_1000 = total/POPULATION*1000,
NO_DATA = case_when(total == 0 ~ 0, TRUE ~ 1))
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("output/", name,"-", col, ".png"))
}
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("output/", name,"-", col, ".png"))
}
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Cote dlvoire", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
setwd('C:/Users/elmsc/Documents/gis/hersh/Sahel-ID')
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("output/", name,"-", col, ".png"))
}
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Chad", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary <- function(x,y,name,col,labels,title) {
country <- aoi %>% filter(COUNTRY == name)
map <- tm_shape(country) + tm_polygons(col = col, n=2,labels = labels, title = title)
map <- map + tm_layout(scale = 1, frame = FALSE) + tm_legend(legend.position = c(x, y))
map
tmap_save(map, filename = paste0("output/", name, "-", col, ".png"))
}
make_single_map_binary("left", "top", "Benin", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("left", "top", "Burkina Faso", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Senegal", "NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Togo", c("No Data Available", "Data Available"), "Data Availibility")
make_single_map_binary("right", "top", "Chad","NO_DATA", c("No Data Available", "Data Available"), "Data Availibility")
countries
